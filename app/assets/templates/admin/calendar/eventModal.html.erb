<div class="modal-header">
  <h3 class="text-center red">
      <span ng-if="availability.start">
      {{ 'admin_calendar.DATE_slot' | translate:{DATE:(availability.start | amDateFormat: 'LL')} }} {{availability.start | amDateFormat:'LT'}} - {{availability.end | amDateFormat:'LT'}}
      </span>
      <span ng-if="!availability.start">
        New Slot
      </span>
  </h3>
</div>
<div class="modal-body" ng-show="step === 1">
  <label class="m-t-sm" translate>{{ 'admin_calendar.what_kind_of_slot_do_you_want_to_create' }}</label>
  <div class="form-group">
    <div class="radio">
      <label>
        <input type="radio" id="training" name="available_type" value="training" ng-model="availability.available_type">
        <span translate>{{ 'admin_calendar.training' }}</span>
      </label>
    </div>
    <div class="radio">
      <label>
        <input type="radio" id="machine" name="available_type" value="machines" ng-model="availability.available_type">
        <span translate>{{ 'admin_calendar.machine' }}</span>
      </label>
    </div>
    <div class="radio" ng-hide="fablabWithoutSpaces">
      <label>
        <input type="radio" id="space" name="available_type" value="space" ng-model="availability.available_type" ng-disabled="spaces.length === 0">
        <span translate>{{ 'admin_calendar.space' }}</span>
      </label>
    </div>
  </div>
</div>
<div class="modal-body" ng-show="step === 2">

  <div ng-show="availability.available_type == 'machines'">
    <p class="text-center font-sbold m-t-sm">{{ 'admin_calendar.select_some_machines' | translate }}</p>

    <div class="form-group m-l-xl">
      <label class="checkbox" ng-repeat="machine in machines">
        <input type="checkbox" ng-click="toggleSelection(machine)" ng-checked="isChecked(machine)"> {{machine.name}} <span class="text-xs">(id {{machine.id}})</span>
      </label>
    </div>
  </div>

  <div ng-show="availability.available_type == 'training'">
    <select ng-model="selectedTraining" class="form-control m-t-sm" ng-options="t as t.name for t in trainings" ng-change="setNbTotalPlaces()">
    </select>
    <div class="row m-t">
      <div class="form-group">
        <label class="col-sm-6 control-label" for="nb_places_training" translate>{{ 'admin_calendar.number_of_tickets' }}</label>
        <div class="col-sm-6">
          <input type="number" id="nb_places_training" class="form-control" ng-model="availability.nb_total_places">
        </div>
      </div>
    </div>
  </div>

  <div ng-show="availability.available_type == 'space'">
    <select ng-model="selectedSpace" class="form-control m-t-sm" ng-options="t as t.name for t in spaces" ng-change="setNbTotalPlaces()">
    </select>
    <div class="row m-t">
      <div class="form-group">
        <label class="col-sm-6 control-label" for="nb_places_space" translate>{{ 'admin_calendar.number_of_tickets' }}</label>
        <div class="col-sm-6">
          <input type="number" id="nb_places_space" class="form-control" ng-model="availability.nb_total_places">
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal-body" ng-show="step === 3">
  <div id="timeAdjust" class="m-t-sm">
      <p class="text-center font-sbold" translate>{{ 'admin_calendar.adjust_the_opening_hours' }}</p>
      <div class="row">
        <div class="col-md-6">
          <label translate>{{ 'start_date' }}</label>
          <div class="input-group">
            <input type="hidden" ng-value="availability.start">
            <input type="text"
                   class="form-control"
                   ng-model="availability.start"
                   uib-datepicker-popup="{{datePicker.format}}"
                   datepicker-options="datePicker.options"
                   is-open="datePicker.startOpened"
                   ng-click="toggleStartDatePicker($event)"
                   required/>
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-click="toggleStartDatePicker($event)"><i class="fa fa-calendar"></i></button>
            </span>
          </div>
          <label translate>{{ 'start_time' }}</label>
          <div>
            <input type="hidden" ng-value="availability.start">
            <uib-timepicker ng-model="availability.start" mousewheel="false" hour-step="timepickers.start.hstep" minute-step="timepickers.start.mstep" show-meridian="ismeridian"></uib-timepicker>
          </div>
        </div><!--col-md-6-->
        <div class="col-md-6">
          <label translate>{{ 'end_date' }}</label>
          <div class="input-group">
            <input type="hidden" ng-value="availability.end">
            <input type="text"
                   class="form-control"
                   ng-model="availability.end"
                   uib-datepicker-popup="{{datePicker.format}}"
                   datepicker-options="datePicker.options"
                   is-open="datePicker.endOpened"
                   ng-click="toggleEndDatePicker($event)"
                   required/>
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-click="toggleEndDatePicker($event)"><i class="fa fa-calendar"></i></button>
            </span>
          </div>
          <label translate>{{ 'end_time' }}</label>
            <div>
              <input type="hidden" ng-value="availability.end">
              <uib-timepicker ng-model="availability.end" mousewheel="false" hour-step="timepickers.end.hstep" minute-step="timepickers.end.mstep" show-meridian="ismeridian"></uib-timepicker>
            </div>
        </div><!--col-md-6-->
      </div><!--row-->
      <hr>
      <div class="row">
        <div class="col-md-6">
          <label translate>{{ 'recurrence' }}</label>
          <select ng-model="availability.recurrence" class="form-control">
            <option value="{{t.value}}" ng-repeat="t in recurrenceTypes">{{t.label}}</option>
          </select>
        </div><!--col-md-6-->
        <div class="col-md-6">
          <div ng-if="availability.recurrence != 'none'">
            {{ '_and_ends_on' | translate }}
            <div class="input-group">
              <input type="hidden" ng-value="availability.recurrence_end_at">
              <input type="text"
                     class="form-control"
                     uib-datepicker-popup="{{datePicker.format}}"
                     datepicker-options="datePicker.options"
                     ng-model="availability.recurrence_end_at"
                     is-open="datePicker.recurrenceEndOpened"
                     ng-required="true"/>
              <span class="input-group-btn">
                <button type="button" class="btn btn-default" ng-click="toggleRecurrenceEnd($event)"><i class="fa fa-calendar"></i></button>
              </span>
            </div>
          </div>
        </div><!--col-md-6-->
      </div><!--row-->

      <!--div class="row">
        <div class="col-md-6 datepicker-wrapper">
          <div uib-datepicker ng-model="availability.start" min-date="datepickerConfig.minDate" starting-day="datepickerConfig.startingDay" show-weeks="datepickerConfig.showWeeks"></div>
        </div>
        <div class="col-md-6 datepicker-wrapper">
          <div uib-datepicker ng-model="availability.end" min-date="datepickerConfig.minDate" starting-day="datepickerConfig.startingDay" show-weeks="datepickerConfig.showWeeks"></div>
        </div>
      </div>
      <div class="row">
          <div class="col-md-3 col-md-offset-2">
              <uib-timepicker ng-model="availability.start" hour-step="timepickers.start.hstep" readonly-input="true" minute-step="timepickers.start.mstep" show-meridian="false"></uib-timepicker>
          </div>
          <span class="col-md-1 m-t-xl m-l" translate>{{ 'admin_calendar.to_time' }}</span>
          <fieldset ng-disabled="endDateReadOnly" class="col-md-5">
              <uib-timepicker ng-model="availability.end" hour-step="timepickers.end.hstep" readonly-input="true" minute-step="timepickers.end.mstep" show-meridian="false"></uib-timepicker>
          </fieldset>
      </div-->
  </div>
  <div id="tagAssociate" class="m-t-lg">
      <p class="text-center font-sbold" translate>{{ 'admin_calendar.restrict_this_slot_with_labels_(optional)' }}</p>
      <div class="row">
          <div class="col-sm-12">
              <ui-select multiple ng-model="availability.tag_ids" class="form-control">
                  <ui-select-match>
                      <span ng-bind="$item.name"></span>
                  </ui-select-match>
                  <ui-select-choices repeat="t.id as t in (tags | filter: $select.search)">
                      <span ng-bind-html="t.name | highlight: $select.search"></span>
                  </ui-select-choices>
              </ui-select>
          </div>
      </div>
  </div>
</div>
<div class="modal-footer" ng-show="step < 3">
  <button class="btn btn-info" ng-click="previous()" ng-disabled="step === 1" translate>{{ 'admin_calendar.previous' }}</button>
  <button class="btn btn-info" ng-click="next()" translate>{{ 'admin_calendar.next' }}</button>
  <button class="btn btn-default" ng-click="cancel()" translate>{{ 'cancel' }}</button>
</div>
<div class="modal-footer" ng-show="step === 3">
  <button class="btn btn-info" ng-click="previous()" translate>{{ 'admin_calendar.previous' }}</button>
  <button class="btn btn-warning" ng-click="ok()" translate>{{ 'confirm' }}</button>
  <button class="btn btn-default" ng-click="cancel()" translate>{{ 'cancel' }}</button>
</div>
